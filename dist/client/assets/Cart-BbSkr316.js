import{r as o,G as I,j as e}from"./components-DQ2b9yAr.js";import{u as q,H as v,c as x,T as d,g as F}from"./Text-D7gGMkA0.js";import{j as u,h as N,C as f}from"./index-Br0rWYvY.js";import{B as b}from"./Button-BlMkXThQ.js";import{L as E}from"./Link-BHsmA1K4.js";import{d as w}from"./Icon-w2kUzEIN.js";import{P as R}from"./ProductCard-Bqw9g1qc.js";import{S as j}from"./Skeleton-DAEh9edr.js";import{f as k}from"./flatten-connection-BTqmuHGw.js";import{I as B}from"./Image-l8cnschg.js";import{M as C}from"./Money-DRLg9VWE.js";function P(t){for(var s=[],r=1;r<arguments.length;r++)s[r-1]=arguments[r];t&&t.addEventListener&&t.addEventListener.apply(t,s)}function T(t){for(var s=[],r=1;r<arguments.length;r++)s[r-1]=arguments[r];t&&t.removeEventListener&&t.removeEventListener.apply(t,s)}var de=typeof window<"u",Q=function(t){o.useEffect(t,[])},O=function(t){var s=o.useRef(t);s.current=t,Q(function(){return function(){return s.current()}})},D=function(t){var s=o.useRef(0),r=o.useState(t),a=r[0],n=r[1],i=o.useCallback(function(c){cancelAnimationFrame(s.current),s.current=requestAnimationFrame(function(){n(c)})},[]);return O(function(){cancelAnimationFrame(s.current)}),[a,i]},S=function(t){var s=D({x:0,y:0}),r=s[0],a=s[1];return o.useEffect(function(){var n=function(){t.current&&a({x:t.current.scrollLeft,y:t.current.scrollTop})};return t.current&&P(t.current,"scroll",n,{capture:!1,passive:!0}),function(){t.current&&T(t.current,"scroll",n)}},[t]),r};function U({count:t=4,heading:s="Shop Best Sellers",layout:r="drawer",onClose:a,query:n,reverse:i,sortKey:c="BEST_SELLING"}){const{load:m,data:l}=I(),L=o.useMemo(()=>Object.entries({count:t,sortKey:c,query:n,reverse:i}).map(([A,h])=>h?`${A}=${h}`:null).filter(Boolean).join("&"),[t,c,n,i]),p=q(`/api/products?${L}`);return o.useEffect(()=>{m(p)},[m,p]),e.jsxs(e.Fragment,{children:[e.jsx(v,{format:!0,size:"copy",className:"t-4",children:s}),e.jsx("div",{className:x(["grid grid-cols-2 gap-x-6 gap-y-8",r==="page"?"md:grid-cols-4 sm:grid-col-4":""]),children:e.jsx($,{count:t,onClick:a,products:l==null?void 0:l.products})})]})}function $({count:t=4,onClick:s,products:r}){const a=o.useId();return r?(r==null?void 0:r.length)===0?e.jsx(d,{format:!0,children:"No products found."}):e.jsx(e.Fragment,{children:r.map(n=>e.jsx(R,{product:n,onClick:s,quickAdd:!0},n.id))}):e.jsx(e.Fragment,{children:[...new Array(t)].map((n,i)=>e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{className:"aspect-[3/4]"}),e.jsx(j,{className:"w-32 h-4"})]},`${a+i}`))})}function le({layout:t,onClose:s,cart:r}){var n,i;const a=!!((i=(n=r==null?void 0:r.lines)==null?void 0:n.edges)!=null&&i.length);return e.jsxs(e.Fragment,{children:[e.jsx(K,{hidden:a,onClose:s,layout:t}),e.jsx(M,{cart:r,layout:t})]})}function M({layout:t,cart:s}){const r=!!s&&s.totalQuantity>0,a={drawer:"grid grid-cols-1 h-screen-no-nav grid-rows-[1fr_auto]",page:"w-full pb-12 grid md:grid-cols-2 md:items-start gap-8 md:gap-8 lg:gap-12"};return e.jsxs("div",{className:a[t],children:[e.jsx(H,{lines:s==null?void 0:s.lines,layout:t}),r&&e.jsxs(V,{cost:s.cost,layout:t,children:[e.jsx(G,{discountCodes:s.discountCodes}),e.jsx(z,{checkoutUrl:s.checkoutUrl})]})]})}function G({discountCodes:t}){var r;const s=((r=t==null?void 0:t.filter(a=>a.applicable))==null?void 0:r.map(({code:a})=>a))||[];return e.jsxs(e.Fragment,{children:[e.jsx("dl",{className:s&&s.length!==0?"grid":"hidden",children:e.jsxs("div",{className:"flex items-center justify-between font-medium",children:[e.jsx(d,{as:"dt",children:"Discount(s)"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{children:e.jsx("button",{children:e.jsx(w,{"aria-hidden":"true",style:{height:18,marginRight:4}})})}),e.jsx(d,{as:"dd",children:s==null?void 0:s.join(", ")})]})]})}),e.jsx(g,{discountCodes:s,children:e.jsxs("div",{className:x("flex","items-center gap-4 justify-between text-copy"),children:[e.jsx("input",{className:F(),type:"text",name:"discountCode",placeholder:"Discount code"}),e.jsx("button",{className:"flex justify-end font-medium whitespace-nowrap",children:"Apply Discount"})]})})]})}function g({discountCodes:t,children:s}){return e.jsx(u,{route:"/cart",action:u.ACTIONS.DiscountCodesUpdate,inputs:{discountCodes:t||[]},children:s})}function H({layout:t="drawer",lines:s}){const r=s?k(s):[],a=o.useRef(null),{y:n}=S(a),i=x([n>0?"border-t":"",t==="page"?"flex-grow md:translate-y-4":"px-6 pb-6 sm-max:pt-2 overflow-auto transition md:px-12"]);return e.jsx("section",{ref:a,"aria-labelledby":"cart-contents",className:i,children:e.jsx("ul",{className:"grid gap-6 md:gap-10",children:r.map(c=>e.jsx(W,{line:c},c.id))})})}function z({checkoutUrl:t}){return t?e.jsx("div",{className:"flex flex-col mt-2",children:e.jsx("a",{href:t,target:"_self",children:e.jsx(b,{as:"span",width:"full",children:"Continue to Checkout"})})}):null}function V({cost:t,layout:s,children:r=null}){var n;const a={drawer:"grid gap-4 p-6 border-t md:px-12",page:"sticky top-nav grid gap-6 p-4 md:px-6 md:translate-y-4 bg-primary/5 rounded w-full"};return e.jsxs("section",{"aria-labelledby":"summary-heading",className:a[s],children:[e.jsx("h2",{id:"summary-heading",className:"sr-only",children:"Order summary"}),e.jsx("dl",{className:"grid",children:e.jsxs("div",{className:"flex items-center justify-between font-medium",children:[e.jsx(d,{as:"dt",children:"Subtotal"}),e.jsx(d,{as:"dd","data-test":"subtotal",children:(n=t==null?void 0:t.subtotalAmount)!=null&&n.amount?e.jsx(C,{data:t==null?void 0:t.subtotalAmount}):"-"})]})}),r]})}function W({line:t}){var i,c,m;const s=N(t==null?void 0:t.id);if(!(t!=null&&t.id))return null;const{id:r,quantity:a,merchandise:n}=t;return typeof a>"u"||!(n!=null&&n.product)?null:e.jsxs("li",{className:"flex gap-4",style:{display:(s==null?void 0:s.action)==="remove"?"none":"flex"},children:[e.jsx("div",{className:"flex-shrink",children:n.image&&e.jsx(B,{width:110,height:110,data:n.image,className:"object-cover object-center w-24 h-24 border rounded md:w-28 md:h-28",alt:n.title})}),e.jsxs("div",{className:"flex justify-between flex-grow",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(v,{as:"h3",size:"copy",children:(i=n==null?void 0:n.product)!=null&&i.handle?e.jsx(E,{to:`/products/${n.product.handle}`,children:((c=n==null?void 0:n.product)==null?void 0:c.title)||""}):e.jsx(d,{children:((m=n==null?void 0:n.product)==null?void 0:m.title)||""})}),e.jsx("div",{className:"grid pb-2",children:((n==null?void 0:n.selectedOptions)||[]).map(l=>e.jsxs(d,{color:"subtle",children:[l.name,": ",l.value]},l.name))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex justify-start text-copy",children:e.jsx(_,{line:t})}),e.jsx(Z,{lineId:r})]})]}),e.jsx(d,{children:e.jsx(J,{line:t,as:"span"})})]})]},r)}function Z({lineId:t}){return e.jsxs(u,{route:"/cart",action:u.ACTIONS.LinesRemove,inputs:{lineIds:[t]},children:[e.jsxs("button",{className:"flex items-center justify-center w-10 h-10 border rounded",type:"submit",children:[e.jsx("span",{className:"sr-only",children:"Remove"}),e.jsx(w,{"aria-hidden":"true"})]}),e.jsx(f,{id:t,data:{action:"remove"}})]})}function _({line:t}){const s=t==null?void 0:t.id,r=N(s);if(!t||typeof(t==null?void 0:t.quantity)>"u")return null;const a=(r==null?void 0:r.quantity)||t.quantity,{id:n}=t,i=Number(Math.max(0,a-1).toFixed(0)),c=Number((a+1).toFixed(0));return e.jsxs(e.Fragment,{children:[e.jsxs("label",{htmlFor:`quantity-${n}`,className:"sr-only",children:["Quantity, ",a]}),e.jsxs("div",{className:"flex items-center border rounded",children:[e.jsx(y,{lines:[{id:n,quantity:i}],children:e.jsxs("button",{name:"decrease-quantity","aria-label":"Decrease quantity",className:"w-10 h-10 transition text-primary/50 hover:text-primary disabled:text-primary/10",value:i,disabled:a<=1,children:[e.jsx("span",{children:"−"}),e.jsx(f,{id:s,data:{quantity:i}})]})}),e.jsx("div",{className:"px-2 text-center","data-test":"item-quantity",children:a}),e.jsx(y,{lines:[{id:n,quantity:c}],children:e.jsxs("button",{className:"w-10 h-10 transition text-primary/50 hover:text-primary",name:"increase-quantity",value:c,"aria-label":"Increase quantity",children:[e.jsx("span",{children:"+"}),e.jsx(f,{id:s,data:{quantity:c}})]})})]})]})}function y({children:t,lines:s}){return e.jsx(u,{route:"/cart",action:u.ACTIONS.LinesUpdate,inputs:{lines:s},children:t})}function J({line:t,priceType:s="regular",...r}){var n,i;if(!((n=t==null?void 0:t.cost)!=null&&n.amountPerQuantity)||!((i=t==null?void 0:t.cost)!=null&&i.totalAmount))return null;const a=s==="regular"?t.cost.totalAmount:t.cost.compareAtAmountPerQuantity;return a==null?null:e.jsx(C,{withoutTrailingZeros:!0,...r,data:a})}function K({hidden:t=!1,layout:s="drawer",onClose:r}){const a=o.useRef(null),{y:n}=S(a),i={drawer:x(["content-start gap-4 px-6 pb-8 transition overflow-y-scroll md:gap-12 md:px-12 h-screen-no-nav md:pb-12",n>0?"border-t":""]),page:x([t?"":"grid","pb-12 w-full md:items-start gap-4 md:gap-8 lg:gap-12"])};return e.jsxs("div",{ref:a,className:i[s],hidden:t,children:[e.jsxs("section",{className:"grid gap-6",children:[e.jsx(d,{format:!0,children:"Looks like you haven’t added anything yet, let’s get you started!"}),e.jsx("div",{children:e.jsx(b,{onClick:r,children:"Continue shopping"})})]}),e.jsx("section",{className:"grid gap-8 pt-16",children:e.jsx(U,{count:4,heading:"Shop Best Sellers",layout:s,onClose:r,sortKey:"BEST_SELLING"})})]})}export{le as C,T as a,de as i,P as o,D as u};
